<% content_for :head do %>
  <%= javascript_include_tag ['jquery.ui.datepicker-it'] %>
  <script type="text/javascript">

    function submitWithAction(action){
      theForm = document.form['new_request'];
      theForm['action']=action;
      theForm.submit();
    }
    
    $j(document).ready(function(){

      // set up date picker
      $j( "#expiration_date" ).datepicker({
        dateFormat: 'dd/mm/yy',
        defaultDate: '<%=@request.expiration!=nil ? @request.expiration.strftime("%d/%m/%Y") : ''%>',
        changeMonth: true,
        changeYear: true
      })

      // set up the two submit buttons
      $j("#btn_save").click(submitWithAction('save'));
      $j("#btn_publish").click(submitWithAction('publish'));
    });
  </script>
<% end %>

<%= form_for(@request) do |f| %>

  <%=hidden_field_tag 'action'%>

  <fieldset>
    <legend>Offerta</legend>
    <div class="notes">
      <h4>Descrivi le tue necessità</h4>
      <p class="last">
        Descrivi le tue necessità in questa scheda
      </p>
    </div>
    <div class="required">
      <%= f.label :title, 'Titolo:' %>
      <%= f.text_field :title, :class=>:inputText, :size=>10, :maxlength=>100 %>
      <small class="error"><%= @request.errors[:title].join(". ") %></small>
      <small>Il titolo permette di identificare la tua richiesta</small>
    </div>

    <div class="required">
      <%= f.label :description, 'Descrizione:' %>
      <%= f.text_area :description, :class=>:inputTextarea, :rows=>10, :cols=>21 %>
      <small class="error"><%= @request.errors[:description].join(". ") %></small>
      <small>Dettaglia la tua richiesta. Più dettagli includerai più sarà
      semplice per gli operatori presentarti delle offerte in linea con la tua richieste.</small>
    </div>

    <div class="required">
      <%= f.label :expiration_date, 'Data di scadenza:' %>
      <%= text_field_tag :expiration_date, @request.expiration!=nil ? @request.expiration.strftime("%d/%m/%Y") : '', :class=>:inputText, :size=>10, :maxlength=>100 %>
      <small class="error"><%= @request.errors[:expiration].join(". ") %></small>
      <small>Data entro la quale vorresti ricevere le offerte.</small>
    </div>
    

    <div class="actions">
      <button id="btn_save" value="Salva">Salva</button>
      <button id="btn_publish" value="Pubblica">Pubblica</button>
    </div>

  </fieldset>

<% end %>